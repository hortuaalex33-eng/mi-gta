<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Mini GTA PRO</title>
<style>
body { margin: 0; overflow: hidden; background: #222; }
canvas { display: block; margin: auto; background: #555; }

.controls {
  position: fixed;
  bottom: 20px;
  width: 100%;
  text-align: center;
}

button {
  width: 60px;
  height: 60px;
  margin: 5px;
  font-size: 20px;
  border-radius: 10px;
  border: none;
}
</style>
</head>
<body>

<canvas id="game" width="400" height="600"></canvas>

<div class="controls">
  <div>
    <button ontouchstart="move('up')" ontouchend="stop()">‚¨ÜÔ∏è</button>
  </div>
  <div>
    <button ontouchstart="move('left')" ontouchend="stop()">‚¨ÖÔ∏è</button>
    <button ontouchstart="move('down')" ontouchend="stop()">‚¨áÔ∏è</button>
    <button ontouchstart="move('right')" ontouchend="stop()">‚û°Ô∏è</button>
  </div>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

// üåÜ MUNDO
const world = {
  width: 1200,
  height: 1200
};

// üé• C√ÅMARA
let camera = { x: 0, y: 0 };

// üßç JUGADOR
let player = {
  x: 600,
  y: 600,
  size: 20,
  speed: 3,
  dx: 0,
  dy: 0
};

// üè† CASAS
let casas = [
  { x: 200, y: 150, w: 100, h: 100 },
  { x: 500, y: 300, w: 120, h: 120 },
  { x: 800, y: 700, w: 90, h: 90 },
  { x: 300, y: 800, w: 150, h: 100 }
];

// üéÆ CONTROLES T√ÅCTILES
function move(dir) {
  if (dir === "up") player.dy = -player.speed;
  if (dir === "down") player.dy = player.speed;
  if (dir === "left") player.dx = -player.speed;
  if (dir === "right") player.dx = player.speed;
}

function stop() {
  player.dx = 0;
  player.dy = 0;
}

// üöß COLISIONES
function colision(a, b) {
  return (
    a.x < b.x + b.w &&
    a.x + player.size > b.x &&
    a.y < b.y + b.h &&
    a.y + player.size > b.y
  );
}

// üîÑ UPDATE
function update() {
  let nuevaX = player.x + player.dx;
  let nuevaY = player.y + player.dy;

  let bloqueado = casas.some(c => colision({x:nuevaX, y:nuevaY}, c));

  if (!bloqueado) {
    player.x = nuevaX;
    player.y = nuevaY;
  }

  // l√≠mites del mundo
  player.x = Math.max(0, Math.min(world.width - player.size, player.x));
  player.y = Math.max(0, Math.min(world.height - player.size, player.y));

  // c√°mara sigue al jugador
  camera.x = player.x - canvas.width / 2;
  camera.y = player.y - canvas.height / 2;

  camera.x = Math.max(0, Math.min(world.width - canvas.width, camera.x));
  camera.y = Math.max(0, Math.min(world.height - canvas.height, camera.y));
}

// üé® DIBUJAR MAPA
function drawMap() {
  ctx.fillStyle = "#777";
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  // calles
  ctx.fillStyle = "#333";
  for (let i = 0; i < world.width; i += 200) {
    ctx.fillRect(i - camera.x, 0 - camera.y, 50, world.height);
  }

  // casas
  ctx.fillStyle = "brown";
  casas.forEach(c => {
    ctx.fillRect(c.x - camera.x, c.y - camera.y, c.w, c.h);
  });
}

// üßç DIBUJAR JUGADOR
function drawPlayer() {
  ctx.fillStyle = "red";
  ctx.fillRect(player.x - camera.x, player.y - camera.y, player.size, player.size);
}

// üîÅ LOOP
function gameLoop() {
  update();
  drawMap();
  drawPlayer();
  requestAnimationFrame(gameLoop);
}

gameLoop();
</script>

</body>
</html>
